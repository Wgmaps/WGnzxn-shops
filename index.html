
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <title>WG 興楠店優惠地圖</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"/>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css" />
  <style>
    html, body {
      height: 100%;
      margin: 0;
      font-family: "Helvetica Neue", sans-serif;
    }
    #map {
      height: 100%;
      width: 100%;
    }
    h1 {
      text-align: center;
      font-size: 20px;
      margin: 12px 0 4px;
      font-weight: bold;
      font-family: "Helvetica Neue", sans-serif;
      color: #d22;
    }
    .ig-box, .line-box {
      position: relative;
      top: 0;
      left: 0;
      transform: none;
      display: block;
      width: fit-content;
      margin: 6px auto;
      background: white;
      padding: 6px 16px;
      border-radius: 16px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      font-size: 14px;
    }
    .ig-box a { text-decoration: none; font-weight: bold; color: #d6336c; }
    .line-box a { text-decoration: none; font-weight: bold; color: #00b900; }
    .search-box {
      position: absolute;
      top: 148px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 999;
      background: white;
      padding: 6px 10px;
      border-radius: 20px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.15);
    }
    .search-box input {
      border: none;
      outline: none;
      font-size: 14px;
      width: 180px;
    }
    .custom-popup {
      padding: 6px 10px;
      border-radius: 10px;
      box-shadow: 0 1px 6px rgba(0,0,0,0.15);
      background-color: #fff;
      max-width: 180px;
      word-break: break-word;
    }
    .custom-popup-title {
      font-weight: bold;
      font-size: 13px;
      margin-bottom: 4px;
    }
    .custom-popup-content {
      font-size: 12px;
      color: #444;
      white-space: pre-line;
    }
  </style>
</head>
<body>
  <h1>🦍🌍 WG 興楠店優惠地圖 💰</h1>
  <div class="ig-box"><a href="https://www.instagram.com/worldgym_nzxn" target="_blank">📸 追蹤我們 IG：@worldgym_nzxn</a></div>
  <div class="line-box"><a href="https://lin.ee/ZLH7DRI" target="_blank">💬 加入我們 LINE 官方帳號</a></div>
  <div class="search-box">
    <input id="shopSearch" placeholder="🔍 搜尋商家名稱…" type="text"/>
  </div>
  <div id="map"></div>

  <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"></script>
  <script>
    const map = L.map('map').setView([22.73, 120.33], 14);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      maxZoom: 19,
      attribution: '&copy; OpenStreetMap contributors'
    }).addTo(map);

    const cuteIcon = L.icon({
      iconUrl: 'icons/cute-icon.png',
      iconSize: [40, 40],
      iconAnchor: [20, 40],
      popupAnchor: [0, -38]
    });

    const shopData = [
      {
        name: "孝傳藥師藥局",
        note: "消費滿200 折20元",
        lat: 22.734155,
        lng: 120.324078
      },
      {
        name: "昕昕早午餐",
        note: "飲品折5元",
        lat: 22.733283,
        lng: 120.324165
      },
      {
        name: "軟食力早午餐",
        note: "任一主餐折10元",
        lat: 22.733851,
        lng: 120.327297
      }
    ];

    shopData.forEach(shop => {
      const popupHtml = \`
        <div class="custom-popup">
          <div class="custom-popup-title">\${shop.name}</div>
          <div class="custom-popup-content">\${shop.note}</div>
        </div>\`;
      L.marker([shop.lat, shop.lng], { icon: cuteIcon })
        .addTo(map)
        .bindPopup(popupHtml);
    });

    // 搜尋功能
    const input = document.getElementById("shopSearch");
    input.addEventListener("keydown", function(e) {
      if (e.key === "Enter") {
        const keyword = input.value.trim();
        const result = shopData.find(s => s.name.includes(keyword));
        if (result) {
          map.setView([result.lat, result.lng], 17);
          L.popup().setLatLng([result.lat, result.lng])
            .setContent(\`<div class="custom-popup"><div class="custom-popup-title">\${result.name}</div></div>\`)
            .openOn(map);
        } else {
          alert("找不到商家名稱：" + keyword);
        }
      }
    });
  </script>
</body>
</html>
